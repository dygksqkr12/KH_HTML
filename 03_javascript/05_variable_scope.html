<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>js - variable | scope</title>
  </head>
  <body>
    <h1>Variable | Scope</h1>
    <input type="button" value="전역 | 지역" onclick="test1();" />
    <input type="button" value="scope" onclick="test2();" />
    <input type="button" value="개선" onclick="test3();" />
    <script>
      //함수 밖 script태그에 작성된 var 변수는 전역변수로 등록된다.
      //최상위 객체 window의 속성으로 등록된다.
      var a;
      a = 100; //변수의 타입이 결정.

      /**
       * 함수 안에 var변수는 지역변수로 등록된다.
       * 지역변수는 함수 밖에서는 절대 접근할 수 없다.
       */
      function test1() {
        var a = "아";
        var b = 123;
        console.log("a = " + a);
        console.log("b = " + b);
        console.log("전역변수 a = " + window.a);
        // (this용법2) 일반함수안에서 this는 window객체를 가리킨다.
        console.log("전역변수 a = " + this.a);

        // 사용금지!!
        // var a = "true"; //중복 선언 가능
        // c = "ㅋㅋㅋ"; //var 없이 선언된 변수는 함수안이라해도 전역변수로 등록
        // console.log("c = " + c);
      }

      /**
       * scope 유효범위
       * c-family언어가 가진 block scope가 아닌,
       * javascript에서는 function scope를 가진다.
       */
      function test2() {
        var x = 10;

        if (true) {
          var x = 100;
        }
        console.log(x);

        for (var i = 0; i < 10; i++) {}
        console.log(i); //10
      }

      var k = 123.456;

      if (true) {
        var k = 456.789;
      }
      console.log(k);

      /**
       * use strict 엄격모드 지원
       *
       * ES6 지원
       * let - block scope를 가진 변수 키워드
       * const - block scope를 가진 상수 키워드
       */
      function test3() {
        // "use strict";
        // foo = 777; //Uncaught ReferenceError: x is not defined
        // console.log(foo);
        let foo = 100;
        // let foo = 200; //Uncaught SyntaxError: Identifier 'foo' has already been declared

        const bar = "상수";
        // bar = "변수냐";  //Uncaught TypeError: Assignment to constant variable.
      }
    </script>
  </body>
</html>
